# ç¬¬ä¸€é˜¶æ®µå¼€å‘æ­¥éª¤æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬æŒ‡å—æä¾›äº†ç¬¬ä¸€é˜¶æ®µå¼€å‘çš„è¯¦ç»†æ­¥éª¤ï¼ŒæŒ‰ç…§ä¾èµ–å…³ç³»å’Œä¼˜å…ˆçº§æ’åºï¼Œç¡®ä¿å¼€å‘è¿‡ç¨‹é¡ºç•…é«˜æ•ˆã€‚

## ğŸš€ å¼€å‘æ­¥éª¤

### Step 1: é¡¹ç›®åˆå§‹åŒ–

#### 1.1 åˆ›å»ºé¡¹ç›®
```bash
npx create-react-app factorio-game --template typescript
cd factorio-game
```

#### 1.2 å®‰è£…ä¾èµ–
```bash
# UIæ¡†æ¶
npm install @mui/material @emotion/react @emotion/styled
npm install @mui/icons-material

# ç±»å‹å®šä¹‰
npm install --save-dev @types/react @types/node
```

#### 1.3 é¡¹ç›®ç»“æ„è®¾ç½®
```
src/
â”œâ”€â”€ components/
â”œâ”€â”€ services/
â”œâ”€â”€ types/
â”œâ”€â”€ hooks/
â”œâ”€â”€ utils/
â””â”€â”€ data/
```

---

### Step 2: åŸºç¡€ç±»å‹å®šä¹‰

#### 2.1 åˆ›å»º `src/types/index.ts`
```typescript
export interface Category {
  id: string;
  name: string;
  icon?: string;
}

export interface Item {
  id: string;
  name: string;
  category: string;
  subgroup?: string;
  description?: string;
  icon?: string;
  stack_size?: number;
  fuel_value?: string;
  type?: string;
  unlocked?: boolean;
}

export interface Recipe {
  id: string;
  name: string;
  category: string;
  time: number;
  in: { [itemId: string]: number };
  out: { [itemId: string]: number };
}

export interface InventoryItem {
  itemId: string;
  currentAmount: number;
  maxCapacity: number;
  productionRate: number;
  consumptionRate: number;
  status: 'producing' | 'stopped' | 'insufficient' | 'inventory_full' | 'researching' | 'normal';
}
```

#### 2.2 åˆ›å»º `src/types/facilities.ts`
```typescript
export interface Facility {
  id: string;
  itemId: string;
  type: string;
  category: 'mining' | 'smelting' | 'crafting' | 'chemical' | 'research' | 'power-generation';
  count: number;
  baseSpeed: number;
  baseInputRate: Record<string, number>;
  baseOutputRate: number;
  powerType: 'electric' | 'fuel' | 'none';
  powerConsumption?: number;
  powerGeneration?: number;
}
```

---

### Step 3: æ ¸å¿ƒæœåŠ¡å±‚

#### 3.1 ç”¨æˆ·è¿›åº¦æœåŠ¡ `src/services/UserProgressService.ts`
- å®ç°å•ä¾‹æ¨¡å¼
- ç®¡ç†ç‰©å“è§£é”çŠ¶æ€
- localStorage æŒä¹…åŒ–
- é»˜è®¤è§£é”åŸºç¡€ç‰©å“

#### 3.2 æ•°æ®æœåŠ¡ `src/services/DataService.ts`
- åŠ è½½æ¸¸æˆæ•°æ®ï¼ˆä» public/data/ï¼‰
- é›†æˆè§£é”çŠ¶æ€è¿‡æ»¤
- æä¾›ç‰©å“æŸ¥è¯¢æ¥å£
- ç®¡ç†åº“å­˜çŠ¶æ€

#### 3.3 è®¾æ–½æœåŠ¡ `src/services/FacilityService.ts`
- ç®¡ç†è®¾æ–½å®ä¾‹
- è®¡ç®—ç”Ÿäº§æ•ˆç‡
- å¤„ç†è®¾æ–½çŠ¶æ€

#### 3.4 ç”µåŠ›æœåŠ¡ `src/services/PowerService.ts`
- è®¡ç®—ç”µåŠ›å¹³è¡¡
- ç®¡ç†å‘ç”µ/ç”¨ç”µè®¾æ–½
- æä¾›ç”µåŠ›ç»Ÿè®¡

---

### Step 4: UIåŸºç¡€æ¡†æ¶

#### 4.1 ä¸»åº”ç”¨å¸ƒå±€ `src/App.tsx`
```typescript
function App() {
  const [selectedTab, setSelectedTab] = useState(0);
  
  return (
    <Box sx={{ display: 'flex', flexDirection: 'column', height: '100vh' }}>
      {/* ä¸»å†…å®¹åŒº */}
      <Box sx={{ flex: 1, overflow: 'auto' }}>
        {selectedTab === 0 && <ProductionModule />}
        {selectedTab === 1 && <FacilitiesModule />}
        {selectedTab === 2 && <TechnologyModule />}
      </Box>
      
      {/* åº•éƒ¨å¯¼èˆª */}
      <BottomNavigation value={selectedTab} onChange={(e, v) => setSelectedTab(v)}>
        <BottomNavigationAction label="ç”Ÿäº§" icon={<BuildIcon />} />
        <BottomNavigationAction label="è®¾æ–½" icon={<FactoryIcon />} />
        <BottomNavigationAction label="ç§‘æŠ€" icon={<ScienceIcon />} />
      </BottomNavigation>
    </Box>
  );
}
```

---

### Step 5: ç”Ÿäº§æ¨¡å—å¼€å‘

#### 5.1 åˆ†ç±»æ ‡ç­¾ç»„ä»¶ `src/components/CategoryTabs.tsx`
- æ˜¾ç¤ºå…­å¤§åˆ†ç±»ï¼ˆç‰©æµã€ç”Ÿäº§ã€ä¸­é—´äº§å“ã€æˆ˜æ–—ã€æµä½“ã€ç§‘æŠ€ï¼‰
- å“åº”å¼å¸ƒå±€
- åˆ†ç±»åˆ‡æ¢åŠŸèƒ½

#### 5.2 ç‰©å“ç½‘æ ¼ç»„ä»¶ `src/components/ItemGrid.tsx`
- ç½‘æ ¼å¸ƒå±€å±•ç¤ºç‰©å“
- ä»…æ˜¾ç¤ºå·²è§£é”ç‰©å“
- å“åº”å¼è®¾è®¡ï¼ˆç§»åŠ¨ç«¯2åˆ—ï¼Œæ¡Œé¢ç«¯4åˆ—ï¼‰

#### 5.3 ç‰©å“å¡ç‰‡ç»„ä»¶ `src/components/ItemCard.tsx`
- æ˜¾ç¤ºç‰©å“å›¾æ ‡ã€åç§°ã€åº“å­˜
- ç‚¹å‡»è§¦å‘è¯¦æƒ…
- çŠ¶æ€æŒ‡ç¤ºå™¨ï¼ˆç”Ÿäº§ä¸­ã€åœæ­¢ç­‰ï¼‰

#### 5.4 ç‰©å“è¯¦æƒ…å¯¹è¯æ¡† `src/components/ItemDetailDialog.tsx`
- æ˜¾ç¤ºå®Œæ•´ç‰©å“ä¿¡æ¯
- é…æ–¹åˆ—è¡¨
- åˆ¶ä½œåŠŸèƒ½
- ç”Ÿäº§é“¾ä¿¡æ¯

---

### Step 6: è®¾æ–½æ¨¡å—å¼€å‘

#### 6.1 è®¾æ–½æ¦‚è§ˆ `src/components/FacilityOverview.tsx`
- æŒ‰ç±»åˆ«åˆ†ç»„æ˜¾ç¤ºè®¾æ–½
- æ˜¾ç¤ºè¿è¡ŒçŠ¶æ€å’Œæ•ˆç‡
- æ‰¹é‡æ“ä½œåŠŸèƒ½

#### 6.2 ç”µåŠ›ç®¡ç†é¢æ¿ `src/components/PowerManagementPanel.tsx`
- ç”µåŠ›æ€»è§ˆå¡ç‰‡ï¼ˆå‘ç”µé‡ã€æ¶ˆè€—é‡ã€å¹³è¡¡ï¼‰
- å‘ç”µè®¾æ–½åˆ—è¡¨
- ç”¨ç”µè®¾æ–½åˆ—è¡¨
- æ•ˆç‡ä¼˜åŒ–å»ºè®®

#### 6.3 è®¾æ–½é…ç½®å¯¹è¯æ¡† `src/components/FacilityConfigDialog.tsx`
- è°ƒæ•´è®¾æ–½æ•°é‡
- é…ç½®ç”Ÿäº§å‚æ•°
- æŸ¥çœ‹è¯¦ç»†ç»Ÿè®¡

---

### Step 7: æ•°æ®é›†æˆ

#### 7.1 å‡†å¤‡æ¸¸æˆæ•°æ®
```
public/
â””â”€â”€ data/
    â””â”€â”€ 1.1/
        â”œâ”€â”€ data.json      # ç‰©å“ã€é…æ–¹ã€åˆ†ç±»æ•°æ®
        â”œâ”€â”€ icons.webp     # ç‰©å“å›¾æ ‡ç²¾çµå›¾
        â””â”€â”€ hash.json      # æ•°æ®ç‰ˆæœ¬æ ¡éªŒ
```

#### 7.2 å›¾æ ‡ç»„ä»¶ `src/components/common/FactorioIcon.tsx`
- ä»ç²¾çµå›¾æå–å›¾æ ‡
- ç¼“å­˜æœºåˆ¶
- åŠ è½½å ä½ç¬¦

---

### Step 8: çŠ¶æ€ç®¡ç†

#### 8.1 ä½¿ç”¨ React Contextï¼ˆç®€å•æ–¹æ¡ˆï¼‰
```typescript
// src/contexts/GameContext.tsx
export const GameContext = createContext<GameState>(null);

export function GameProvider({ children }) {
  const [inventory, setInventory] = useState(new Map());
  const [facilities, setFacilities] = useState([]);
  
  return (
    <GameContext.Provider value={{ inventory, facilities, ... }}>
      {children}
    </GameContext.Provider>
  );
}
```

#### 8.2 æˆ–ä½¿ç”¨ Zustandï¼ˆæ¨èï¼‰
```typescript
// src/store/gameStore.ts
import { create } from 'zustand';

export const useGameStore = create((set) => ({
  inventory: new Map(),
  facilities: [],
  updateInventory: (itemId, amount) => set(state => {
    // æ›´æ–°é€»è¾‘
  }),
}));
```

---

### Step 9: åŠŸèƒ½å®Œå–„

#### 9.1 åˆ¶ä½œé˜Ÿåˆ—
- å®ç°åˆ¶ä½œä»»åŠ¡é˜Ÿåˆ—ï¼ˆæœ€å¤š10ä¸ªï¼‰
- è¿›åº¦è®¡ç®—
- è‡ªåŠ¨å®Œæˆå’Œåº“å­˜æ›´æ–°

#### 9.2 è‡ªåŠ¨ä¿å­˜
- æ¯30ç§’è‡ªåŠ¨ä¿å­˜
- ä¿å­˜åˆ° localStorage
- ä¿å­˜æç¤º

#### 9.3 æ•°æ®å¯¼å…¥/å¯¼å‡º
- JSONæ ¼å¼å­˜æ¡£
- å‹ç¼©å­˜å‚¨
- ç‰ˆæœ¬å…¼å®¹æ€§æ£€æŸ¥

---

### Step 10: ä¼˜åŒ–å’Œæµ‹è¯•

#### 10.1 æ€§èƒ½ä¼˜åŒ–
- React.memo ä¼˜åŒ–æ¸²æŸ“
- useMemo ç¼“å­˜è®¡ç®—
- è™šæ‹Ÿæ»šåŠ¨ï¼ˆç‰©å“åˆ—è¡¨ï¼‰
- å›¾ç‰‡æ‡’åŠ è½½

#### 10.2 å“åº”å¼é€‚é…
- ç§»åŠ¨ç«¯å¸ƒå±€è°ƒæ•´
- è§¦æ‘¸æ‰‹åŠ¿æ”¯æŒ
- è‡ªé€‚åº”å­—ä½“å¤§å°

#### 10.3 é”™è¯¯å¤„ç†
- å…¨å±€é”™è¯¯è¾¹ç•Œ
- æœåŠ¡å¼‚å¸¸å¤„ç†
- ç”¨æˆ·å‹å¥½çš„é”™è¯¯æç¤º

---

## ğŸ“ å¼€å‘é¡ºåºå»ºè®®

### ç¬¬ä¸€å‘¨ï¼šåŸºç¡€æ¶æ„
1. âœ… é¡¹ç›®åˆå§‹åŒ–
2. âœ… ç±»å‹å®šä¹‰
3. âœ… æ ¸å¿ƒæœåŠ¡ï¼ˆUserProgress, Dataï¼‰
4. âœ… åŸºç¡€UIæ¡†æ¶

### ç¬¬äºŒå‘¨ï¼šç”Ÿäº§æ¨¡å—
5. âœ… ç‰©å“è§£é”ç³»ç»Ÿ
6. âœ… ç‰©å“åˆ—è¡¨å±•ç¤º
7. âœ… ç‰©å“è¯¦æƒ…åŠŸèƒ½
8. âœ… åˆ¶ä½œé˜Ÿåˆ—

### ç¬¬ä¸‰å‘¨ï¼šè®¾æ–½æ¨¡å—
9. â¬œ è®¾æ–½ç®¡ç†ç•Œé¢
10. â¬œ ç”µåŠ›ç³»ç»Ÿ
11. â¬œ è®¾æ–½é…ç½®åŠŸèƒ½

### ç¬¬å››å‘¨ï¼šå®Œå–„å’Œä¼˜åŒ–
12. â¬œ æ•°æ®æŒä¹…åŒ–
13. â¬œ æ€§èƒ½ä¼˜åŒ–
14. â¬œ æµ‹è¯•å’Œä¿®å¤

---

## ğŸ¯ å…³é”®æ£€æŸ¥ç‚¹

### æ£€æŸ¥ç‚¹1ï¼šåŸºç¡€åŠŸèƒ½ï¼ˆç¬¬ä¸€å‘¨æœ«ï¼‰
- [ ] èƒ½å¤Ÿæ˜¾ç¤ºç‰©å“åˆ—è¡¨
- [ ] ç‰©å“è§£é”ç³»ç»Ÿæ­£å¸¸å·¥ä½œ
- [ ] åŸºç¡€UIå¯¼èˆªåŠŸèƒ½

### æ£€æŸ¥ç‚¹2ï¼šæ ¸å¿ƒç©æ³•ï¼ˆç¬¬äºŒå‘¨æœ«ï¼‰
- [ ] å¯ä»¥æŸ¥çœ‹ç‰©å“è¯¦æƒ…
- [ ] å¯ä»¥åˆ¶ä½œç‰©å“
- [ ] åº“å­˜ç³»ç»Ÿæ­£å¸¸å·¥ä½œ

### æ£€æŸ¥ç‚¹3ï¼šè®¾æ–½ç³»ç»Ÿï¼ˆç¬¬ä¸‰å‘¨æœ«ï¼‰
- [ ] è®¾æ–½å¯ä»¥æ­£å¸¸æ·»åŠ /åˆ é™¤
- [ ] ç”µåŠ›è®¡ç®—å‡†ç¡®
- [ ] ç”Ÿäº§é“¾å¯è§†åŒ–

### æ£€æŸ¥ç‚¹4ï¼šå‘å¸ƒå°±ç»ªï¼ˆç¬¬å››å‘¨æœ«ï¼‰
- [ ] æ•°æ®æŒä¹…åŒ–ç¨³å®š
- [ ] æ€§èƒ½è¾¾æ ‡ï¼ˆ60fpsï¼‰
- [ ] æ— æ˜æ˜¾bug

---

## ğŸ’¡ å¼€å‘æŠ€å·§

### 1. ç»„ä»¶å¼€å‘é¡ºåº
- å…ˆå¼€å‘å±•ç¤ºç»„ä»¶ï¼ˆæ— çŠ¶æ€ï¼‰
- å†æ·»åŠ äº¤äº’åŠŸèƒ½
- æœ€åé›†æˆä¸šåŠ¡é€»è¾‘

### 2. æ•°æ®æµè®¾è®¡
- è‡ªä¸Šè€Œä¸‹çš„æ•°æ®æµ
- æ˜ç¡®çš„çŠ¶æ€ç®¡ç†
- é¿å…ç»„ä»¶é—´ç›´æ¥é€šä¿¡

### 3. è°ƒè¯•å»ºè®®
- ä½¿ç”¨ React DevTools
- æ·»åŠ è¯¦ç»†çš„æ—¥å¿—
- ç¼–å†™å•å…ƒæµ‹è¯•

### 4. æ€§èƒ½ç›‘æ§
- ä½¿ç”¨ React Profiler
- ç›‘æ§æ¸²æŸ“æ¬¡æ•°
- åŠæ—¶ä¼˜åŒ–ç“¶é¢ˆ

---

## ğŸš¨ å¸¸è§é—®é¢˜

### Q1: ç‰©å“å›¾æ ‡æ— æ³•æ˜¾ç¤º
- æ£€æŸ¥ç²¾çµå›¾è·¯å¾„
- ç¡®è®¤å›¾æ ‡åæ ‡æ­£ç¡®
- æŸ¥çœ‹æ§åˆ¶å°é”™è¯¯

### Q2: è§£é”çŠ¶æ€ä¸æŒä¹…
- æ£€æŸ¥ localStorage æƒé™
- ç¡®è®¤ä¿å­˜é€»è¾‘æ‰§è¡Œ
- æŸ¥çœ‹å­˜å‚¨æ•°æ®æ ¼å¼

### Q3: æ€§èƒ½é—®é¢˜
- å‡å°‘ä¸å¿…è¦çš„æ¸²æŸ“
- ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨
- ä¼˜åŒ–å¤§æ•°æ®ç»“æ„

---

## ğŸ“š å‚è€ƒèµ„æº

- [React å®˜æ–¹æ–‡æ¡£](https://react.dev/)
- [Material-UI æ–‡æ¡£](https://mui.com/)
- [TypeScript æ‰‹å†Œ](https://www.typescriptlang.org/docs/)
- [Factorio Wiki](https://wiki.factorio.com/)